<html>
<head>
<title>Memory.java</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.ln { color: #606366; font-weight: normal; font-style: normal; }
.s0 { color: rgb(204,120,50); }
.s1 { color: rgb(169,183,198); }
.s2 { color: rgb(98,151,85); font-style: italic; }
.s3 { color: rgb(98,151,85); font-weight: bold; font-style: italic; }
.s4 { color: rgb(106,135,89); }
.s5 { color: rgb(128,128,128); }
.s6 { color: rgb(104,151,187); }
</style>
</head>
<BODY BGCOLOR="#2b2b2b">
<TABLE CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<TR><TD><CENTER>
<FONT FACE="Arial, Helvetica" COLOR="#000000">
Memory.java</FONT>
</center></TD></TR></TABLE>
<pre>
<span class="s0">package </span><span class="s1">tilbe.ibay.estrada.rambo</span><span class="s0">;</span><span class="s1"> 
 
</span><span class="s0">import </span><span class="s1">java.time.Duration</span><span class="s0">;</span><span class="s1"> 
</span><span class="s0">import </span><span class="s1">java.time.LocalTime</span><span class="s0">;</span><span class="s1"> 
</span><span class="s0">import </span><span class="s1">java.util.ArrayList</span><span class="s0">;</span><span class="s1"> 
 
</span><span class="s2">/** 
 * 
 * </span><span class="s3">@author </span><span class="s2">IJTilbe 
 */</span><span class="s1"> 
</span><span class="s0">public class </span><span class="s1">Memory{ 
    </span><span class="s0">int </span><span class="s1">memoryAvailable</span><span class="s0">;</span><span class="s1"> 
    </span><span class="s0">int </span><span class="s1">remainingMemory</span><span class="s0">;</span><span class="s1"> 
    ArrayList&lt;Partition&gt; partitionList</span><span class="s0">;</span><span class="s1"> 
    ArrayList&lt;Job&gt; jobList</span><span class="s0">;</span><span class="s1"> 
    </span><span class="s0">public </span><span class="s1">Memory(</span><span class="s0">int </span><span class="s1">memoryAvailable</span><span class="s0">, </span><span class="s1">String compaction) { 
        </span><span class="s0">this</span><span class="s1">.memoryAvailable = memoryAvailable</span><span class="s0">;</span><span class="s1"> 
        remainingMemory = memoryAvailable</span><span class="s0">;</span><span class="s1"> 
        </span><span class="s0">if </span><span class="s1">(compaction.equals(</span><span class="s4">&quot;without&quot;</span><span class="s1">)) { 
            partitionList = </span><span class="s0">new </span><span class="s1">ArrayList&lt;&gt;()</span><span class="s0">;</span><span class="s1"> 
            partitionList.add(</span><span class="s0">new </span><span class="s1">Partition(memoryAvailable))</span><span class="s0">;</span><span class="s1"> 
        } </span><span class="s0">else </span><span class="s1">{ 
            jobList = </span><span class="s0">new </span><span class="s1">ArrayList&lt;&gt;()</span><span class="s0">;</span><span class="s1"> 
        } 
 
    } 
 
    </span><span class="s0">public int </span><span class="s1">getMemoryAvailable() { 
        </span><span class="s0">return </span><span class="s1">memoryAvailable</span><span class="s0">;</span><span class="s1"> 
    } 
 
    </span><span class="s0">private class </span><span class="s1">Partition{ 
        </span><span class="s0">int </span><span class="s1">memorySize</span><span class="s0">;</span><span class="s1"> 
        <a href="Job.java.html">Job</a> job</span><span class="s0">;</span><span class="s1"> 
 
        </span><span class="s0">public </span><span class="s1">Partition(<a href="Job.java.html">Job</a> job) { 
            </span><span class="s0">this</span><span class="s1">.job = job</span><span class="s0">;</span><span class="s1"> 
            </span><span class="s0">this</span><span class="s1">.memorySize = job.getSize()</span><span class="s0">;</span><span class="s1"> 
        } 
 
        </span><span class="s0">public </span><span class="s1">Partition(</span><span class="s0">int </span><span class="s1">memorySize) { 
            </span><span class="s0">this</span><span class="s1">.job = </span><span class="s0">null;</span><span class="s1"> 
            </span><span class="s0">this</span><span class="s1">.memorySize = memorySize</span><span class="s0">;</span><span class="s1"> 
        } 
 
    } 
 
    </span><span class="s5">//for adding partitions with compaction</span><span class="s1"> 
    </span><span class="s0">public <a href="Job.java.html">Job</a> </span><span class="s1">addPartitionWith(<a href="Job.java.html">Job</a> job</span><span class="s0">, </span><span class="s1">LocalTime time){ 
        </span><span class="s0">if </span><span class="s1">(memoryAvailable &gt;= job.getSize()) { 
            memoryAvailable -= job.getSize()</span><span class="s0">;</span><span class="s1"> 
            jobList.add(job)</span><span class="s0">;</span><span class="s1"> 
            job.setStatus(</span><span class="s4">&quot;allocated&quot;</span><span class="s1">)</span><span class="s0">;</span><span class="s1"> 
            job.setTimeStarted(time)</span><span class="s0">;</span><span class="s1"> 
            job.setTimeFinished(time.plusMinutes(job.getRunTime()))</span><span class="s0">;</span><span class="s1"> 
            job.setWaitingTime(Math.toIntExact(Duration.between(job.getArrivalTime()</span><span class="s0">, </span><span class="s1">job.getTimeStarted()).toMinutes()))</span><span class="s0">;</span><span class="s1"> 
            job.setWhenAllocated(memoryAvailable)</span><span class="s0">;</span><span class="s1"> 
            System.out.println(</span><span class="s4">&quot;Update: Job No &quot; </span><span class="s1">+ job.getJobNo() + </span><span class="s4">&quot; Allocated&quot;</span><span class="s1">)</span><span class="s0">;</span><span class="s1"> 
        } </span><span class="s0">else </span><span class="s1">{ 
            System.out.println(</span><span class="s4">&quot;Insufficient memory to create new partition&quot;</span><span class="s1">)</span><span class="s0">;</span><span class="s1"> 
        } 
        </span><span class="s0">return </span><span class="s1">job</span><span class="s0">;</span><span class="s1"> 
    } 
 
    </span><span class="s0">public <a href="Job.java.html">Job</a> </span><span class="s1">addPartitionWithout(<a href="Job.java.html">Job</a> job</span><span class="s0">, </span><span class="s1">LocalTime time){ 
        </span><span class="s0">if </span><span class="s1">(memoryAvailable &gt; </span><span class="s6">0</span><span class="s1">) { 
            System.out.println(</span><span class="s4">&quot;Job No &quot; </span><span class="s1">+ job.getJobNo() + </span><span class="s4">&quot;: Finding free partitions...&quot;</span><span class="s1">)</span><span class="s0">;</span><span class="s1"> 
            </span><span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s6">0</span><span class="s0">; </span><span class="s1">i &lt; partitionList.size()</span><span class="s0">; </span><span class="s1">i++) { 
                Partition p = partitionList.get(i)</span><span class="s0">;</span><span class="s1"> 
                </span><span class="s0">if</span><span class="s1">((p.memorySize &gt; job.getSize()) &amp;&amp; (p.job == </span><span class="s0">null</span><span class="s1">)){ 
                    p.job = job</span><span class="s0">;</span><span class="s1"> 
                    </span><span class="s0">int </span><span class="s1">memoryRemaining = p.memorySize - job.getSize()</span><span class="s0">;</span><span class="s1"> 
 
                    </span><span class="s0">if</span><span class="s1">(memoryRemaining &gt; </span><span class="s6">0</span><span class="s1">) 
                        partitionList.add(i+</span><span class="s6">1</span><span class="s0">, new </span><span class="s1">Partition(memoryRemaining))</span><span class="s0">;</span><span class="s1"> 
 
                    p.memorySize = job.getSize()</span><span class="s0">;</span><span class="s1"> 
                    memoryAvailable -= job.getSize()</span><span class="s0">;</span><span class="s1"> 
                    job.setStatus(</span><span class="s4">&quot;allocated&quot;</span><span class="s1">)</span><span class="s0">;</span><span class="s1"> 
                    job.setTimeStarted(time)</span><span class="s0">;</span><span class="s1"> 
                    job.setTimeFinished(time.plusMinutes(job.getRunTime()))</span><span class="s0">;</span><span class="s1"> 
                    job.setWaitingTime(Math.toIntExact(Duration.between(job.getArrivalTime()</span><span class="s0">, </span><span class="s1">job.getTimeStarted()).toMinutes()))</span><span class="s0">;</span><span class="s1"> 
                    job.setWhenAllocated(memoryAvailable)</span><span class="s0">;</span><span class="s1"> 
                    System.out.println(</span><span class="s4">&quot;Update: Job No &quot; </span><span class="s1">+ job.getJobNo() + </span><span class="s4">&quot; Allocated&quot;</span><span class="s1">)</span><span class="s0">;</span><span class="s1"> 
                    </span><span class="s0">break;</span><span class="s1"> 
                } 
            } 
        } </span><span class="s0">else </span><span class="s1">{ 
            System.out.println(</span><span class="s4">&quot;Insufficient memory to create new partition&quot;</span><span class="s1">)</span><span class="s0">;</span><span class="s1"> 
        } 
        </span><span class="s0">return </span><span class="s1">job</span><span class="s0">;</span><span class="s1"> 
    } 
 
    </span><span class="s0">public void </span><span class="s1">updateJobWithout(LocalTime currentTime){ 
 
        </span><span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s6">0</span><span class="s0">; </span><span class="s1">i &lt; partitionList.size()</span><span class="s0">; </span><span class="s1">i++) { 
            <a href="Job.java.html">Job</a> j = partitionList.get(i).job</span><span class="s0">;</span><span class="s1"> 
            </span><span class="s0">if </span><span class="s1">((j != </span><span class="s0">null</span><span class="s1">)) { 
                </span><span class="s0">if </span><span class="s1">((j.getStatus().equals(</span><span class="s4">&quot;allocated&quot;</span><span class="s1">)) &amp;&amp; j.getTimeFinished().isBefore(currentTime.plusMinutes(</span><span class="s6">1</span><span class="s1">))) { 
                    partitionList.get(i).job.setStatus(</span><span class="s4">&quot;done&quot;</span><span class="s1">)</span><span class="s0">;</span><span class="s1"> 
                    memoryAvailable += j.getSize()</span><span class="s0">;</span><span class="s1"> 
                    partitionList.get(i).job = </span><span class="s0">null;</span><span class="s1"> 
 
                } 
            } 
        } 
 
    } 
 
    </span><span class="s0">public void </span><span class="s1">updateJobWith(LocalTime currentTime){ 
        </span><span class="s0">if </span><span class="s1">(!jobList.isEmpty()) { 
            </span><span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s6">0</span><span class="s0">; </span><span class="s1">i &lt; jobList.size()</span><span class="s0">; </span><span class="s1">i++) { 
                <a href="Job.java.html">Job</a> j = jobList.get(i)</span><span class="s0">;</span><span class="s1"> 
                </span><span class="s0">if </span><span class="s1">((j != </span><span class="s0">null</span><span class="s1">)) { 
                    </span><span class="s0">if </span><span class="s1">((j.getStatus().equals(</span><span class="s4">&quot;allocated&quot;</span><span class="s1">)) &amp;&amp; j.getTimeFinished().isBefore(currentTime.plusMinutes(</span><span class="s6">1</span><span class="s1">))) { 
                        jobList.get(i).setStatus(</span><span class="s4">&quot;done&quot;</span><span class="s1">)</span><span class="s0">;</span><span class="s1"> 
                        memoryAvailable += j.getSize()</span><span class="s0">;</span><span class="s1"> 
                    } 
                } 
            } 
        } 
    } 
 
    </span><span class="s0">public void </span><span class="s1">mergeEmptyPartitions(){ 
        </span><span class="s0">if </span><span class="s1">(partitionList.size() &gt; </span><span class="s6">2</span><span class="s1">) { 
            </span><span class="s0">int </span><span class="s1">partitionListSize = partitionList.size() - </span><span class="s6">1</span><span class="s0">;</span><span class="s1"> 
            </span><span class="s0">for </span><span class="s1">(</span><span class="s0">int </span><span class="s1">i = </span><span class="s6">0</span><span class="s0">; </span><span class="s1">i &lt; partitionListSize</span><span class="s0">; </span><span class="s1">i++) { 
                </span><span class="s0">if</span><span class="s1">((partitionList.get(i).job == </span><span class="s0">null</span><span class="s1">) &amp;&amp; (partitionList.get(i+</span><span class="s6">1</span><span class="s1">).job == </span><span class="s0">null</span><span class="s1">)){ 
                    </span><span class="s0">int </span><span class="s1">temp = partitionList.get(i).memorySize + partitionList.get(i+</span><span class="s6">1</span><span class="s1">).memorySize</span><span class="s0">;</span><span class="s1"> 
                    partitionList.get(i).memorySize = temp</span><span class="s0">;</span><span class="s1"> 
                    partitionList.remove(i+</span><span class="s6">1</span><span class="s1">)</span><span class="s0">;</span><span class="s1"> 
                    partitionListSize = partitionList.size() - </span><span class="s6">1</span><span class="s0">;</span><span class="s1"> 
                    i = </span><span class="s6">0</span><span class="s0">;</span><span class="s1"> 
                } 
            } 
 
        } 
 
    } 
 
} 
</span></pre>
</body>
</html>